---
prerequisite_packages:
  - fedora-workstation-repositories
  - https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm
  - https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm

pre_install:
  run:
    - >
      grep 'fastestmirror=1' /etc/dnf/dnf.conf ||
      echo 'fastestmirror=1' |
      sudo tee -a /etc/dnf/dnf.conf
    - >
      grep 'max_parallel_downloads=10' /etc/dnf/dnf.conf ||
      echo 'max_parallel_downloads=10' |
      sudo tee -a /etc/dnf/dnf.conf
    - >
      grep 'defaultyes=True' /etc/dnf/dnf.conf ||
      echo 'defaultyes=True' |
      sudo tee -a /etc/dnf/dnf.conf

include:
  - vars/fedora/base_packages.yaml
  - vars/fedora/desktop_packages.yaml
  - vars/fedora/dnf_config.yaml
  # - vars/fedora/docker.yaml
  # - vars/fedora/dynare.yaml
  # - vars/fedora/existing_packages.yaml
  # - vars/fedora/games.yaml
  - vars/fedora/gnome.yaml
  # - vars/fedora/grib_packages.yaml
  # - vars/fedora/ifort.yaml
  - vars/fedora/julia.yaml
  - vars/fedora/logi.yaml
  - vars/fedora/main.yaml
  - vars/fedora/matlab.yaml
  - vars/fedora/r.yaml
  - vars/fedora/stata.yaml
  - vars/fedora/sway.yaml
  - vars/fedora/tex.yaml
  - vars/fedora/workstation.yaml
  # - vars/fedora/p14s.yaml
  # - vars/fedora/tlp.yaml

remove:
  - cheese
  - gnome-boxes
  - gnome-shell-extension-window-list
  - gnome-tour
  - gnome-photos
  - gnome-maps
  - gnome-help
  - abiword
  - mediawriter
  - fedora-chromium-config
  - blueman-nautilus
  # - PackageKit-gstreamer-plugin
  # - PackageKit
  # - PackageKit-command-not-found
  # - gnome-software

post_install:
  run:
    - sudo dnf groupupdate core
    # - sudo dnf install -y --setopt=install_weak_deps=False
    # - sudo systemctl disable packagekit.service
    # - sudo systemctl mask packagekit.service
    # - sudo systemctl disable packagekit-offline-update.service
    # - sudo systemctl mask packagekit-offline-update.service

