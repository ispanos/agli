---
prerequisite_packages:
  - fedora-workstation-repositories
  - https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm
  - https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm

pre_install:
  run:
    - >
      grep 'fastestmirror=1' /etc/dnf/dnf.conf ||
      echo 'fastestmirror=1' |
      sudo tee -a /etc/dnf/dnf.conf
    - >
      grep 'max_parallel_downloads=10' /etc/dnf/dnf.conf ||
      echo 'max_parallel_downloads=10' |
      sudo tee -a /etc/dnf/dnf.conf
    - >
      grep 'defaultyes=True' /etc/dnf/dnf.conf ||
      echo 'defaultyes=True' |
      sudo tee -a /etc/dnf/dnf.conf
    - sudo dnf groupupdate core

# include:
#   - vars/fedora/base.yml
#   - vars/fedora/desktop.yml
#   - vars/fedora/dnf_config.yml
#   - vars/fedora/docker.yml
#   - vars/fedora/dynare.yml
#   - vars/fedora/existing_packages.yml
#   - vars/fedora/games.yml
#   - vars/fedora/gnome.yml
#   - vars/fedora/grib.yml
#   - vars/fedora/ifort.yml
#   - vars/fedora/julia.yml
#   - vars/fedora/logi.yml
#   - vars/fedora/main.yml
#   - vars/fedora/matlab.yml
#   - vars/fedora/r.yml
#   - vars/fedora/stata.yml
#   - vars/fedora/sway.yml
#   - vars/fedora/tex.yml
#   - vars/fedora/workstation.yml
#   - vars/fedora/tlp.yml

remove:
  - cheese
  - gnome-boxes
  - gnome-shell-extension-window-list
  - gnome-tour
  - gnome-photos
  - gnome-maps
  - gnome-help
  - abiword
  - mediawriter
  - fedora-chromium-config
  - blueman-nautilus
  # - PackageKit-gstreamer-plugin
  # - PackageKit
  # - PackageKit-command-not-found
  # - gnome-software

post_install:
  run:
    # - sudo dnf install -y --setopt=install_weak_deps=False
    # - sudo systemctl disable packagekit.service
    # - sudo systemctl mask packagekit.service
    # - sudo systemctl disable packagekit-offline-update.service
    # - sudo systemctl mask packagekit-offline-update.service
